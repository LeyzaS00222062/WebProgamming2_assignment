
<div class="review-form-container">
  <h3>Write Your Review</h3>
  
  <form [formGroup]="reviewForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label>Rating *</label>
      <div class="star-rating">
        <span 
          *ngFor="let star of [1,2,3,4,5]"
          class="star {{ getStarClass(star) }}"
          (click)="setRating(star)"
          (mouseenter)="setHoveredRating(star)"
          (mouseleave)="clearHoveredRating()">
          â˜…
        </span>
      </div>
      <div *ngIf="rating?.invalid && rating?.touched" class="error-message">
        <small>Please select a rating</small>
      </div>
    </div>

    <div class="form-group">
      <label for="reviewText">Your Review *</label>
      <textarea 
        id="reviewText"
        formControlName="reviewText"
        rows="5"
        placeholder="Share your thoughts about this movie..."
        class="form-control"
        [class.is-invalid]="reviewText?.invalid && reviewText?.touched">
      </textarea>
      <div class="char-count">
        {{ reviewForm.value.reviewText?.length || 0 }} / 500 characters
      </div>
      <div *ngIf="reviewText?.invalid && reviewText?.touched" class="error-message">
        <small *ngIf="reviewText?.errors?.['required']">Review text is required</small>
        <small *ngIf="reviewText?.errors?.['minlength']">Review must be at least 10 characters</small>
        <small *ngIf="reviewText?.errors?.['maxlength']">Review cannot exceed 500 characters</small>
      </div>
    </div>

    <div *ngIf="errorMessage" class="alert alert-danger">
      {{ errorMessage }}
    </div>

    <button 
      type="submit" 
      class="btn btn-primary"
      [disabled]="reviewForm.invalid || isSubmitting">
      <span *ngIf="!isSubmitting">Submit Review</span>
      <span *ngIf="isSubmitting">Submitting...</span>
    </button>
  </form>
</div>
